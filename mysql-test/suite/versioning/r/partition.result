create table t1 (x int)
with system versioning
engine innodb
partition by range columns (x) (
partition p0 values less than (100),
partition p1 values less than (1000));
insert into t1 values (3), (300);
select * from t1;
x
3
300
select * from t1 partition (p0);
x
3
select * from t1 partition (p1);
x
300
delete from t1;
select * from t1;
x
select * from t1 for system_time all;
x
3
300
select * from t1 partition (p0) for system_time all;
x
3
select * from t1 partition (p1) for system_time all;
x
300
create or replace table t1 (x int)
partition by system_time (
partition p0 versioning,
partition pn as of now);
ERROR HY000: System Versioning required: `BY SYSTEM_TIME` partitioning
create or replace table t1 (x int);
alter table t1
partition by system_time (
partition p0 versioning,
partition pn as of now);
ERROR HY000: System Versioning required: `BY SYSTEM_TIME` partitioning
create or replace table t1 (x int)
with system versioning
partition by system_time (
partition p0 as of now);
ERROR HY000: Wrong parameters for `BY SYSTEM_TIME`: unexpected number of partitions (expected > 1)
create or replace table t1 (x int)
with system versioning
partition by system_time (
partition p0 as of now,
partition p1 as of now);
ERROR HY000: Wrong parameters for `BY SYSTEM_TIME`: multiple `AS OF NOW` partitions
create or replace table t1 (x int)
with system versioning
partition by system_time (
partition p0 versioning,
partition p1 versioning);
ERROR HY000: Wrong parameters for `BY SYSTEM_TIME`: no `AS OF NOW` partition defined
create or replace table t1 (x int)
with system versioning
partition by system_time (
partition pn as of now,
partition p0 versioning);
ERROR HY000: Wrong parameters for `BY SYSTEM_TIME`: AS OF NOW partition is not last
create or replace table t1 (x int)
with system versioning
partition by system_time (
partition p0 versioning,
partition pn as of now);
alter table t1 add partition (
partition p1 as of now);
ERROR HY000: Wrong parameters for `BY SYSTEM_TIME`: AS OF NOW partition can not be added
insert into t1 values (1);
select * from t1;
x
1
select * from t1 partition (p0);
x
select * from t1 partition (pn);
x
1
delete from t1;
select * from t1 partition (p0) for system_time all;
x
1
select * from t1 partition (pn) for system_time all;
x
create or replace table t1 (x int)
with system versioning
engine myisam
partition by system_time limit 1 (
partition p0 versioning,
partition p1 versioning,
partition pn as of now);
insert into t1 values (1), (2);
select * from t1 partition (pn);
x
1
2
delete from t1;
Warnings:
Note	4042	Switching from partition `p0` to `p1`
select * from t1 partition (p0) for system_time all;
x
1
select * from t1 partition (p1) for system_time all;
x
2
insert into t1 values (3);
delete from t1;
Warnings:
Warning	4040	Using full partition `p1`, need more VERSIONING partitions!
select * from t1 partition (p1) for system_time all;
x
2
3
create or replace table t1 (x int)
with system versioning
engine myisam
partition by system_time interval 1 second (
partition p0 versioning,
partition p1 versioning,
partition pn as of now);
insert into t1 values (1), (2), (3);
select * from t1 partition (pn);
x
1
2
3
delete from t1;
select * from t1 partition (p0) for system_time all;
x
1
2
3
insert into t1 values (4);
delete from t1;
Warnings:
Note	4042	Switching from partition `p0` to `p1`
select * from t1 partition (p1) for system_time all;
x
4
create or replace table t1 (x int)
with system versioning
engine myisam
partition by system_time limit 1
subpartition by key (x)
subpartitions 2 (
partition p0 versioning,
partition p1 versioning,
partition pn as of now);
insert into t1 (x) values (1), (2), (3);
select * from t1 partition (pnsp0);
x
1
3
select * from t1 partition (pnsp1);
x
2
delete from t1;
Warnings:
Note	4042	Switching from partition `p0` to `p1`
Warning	4040	Using full partition `p1`, need more VERSIONING partitions!
select * from t1 partition (p0sp0) for system_time all;
x
1
select * from t1 partition (p0sp1) for system_time all;
x
select * from t1 partition (p1sp0) for system_time all;
x
3
select * from t1 partition (p1sp1) for system_time all;
x
2
drop table t1;
