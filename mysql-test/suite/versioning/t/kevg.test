create table t (a int) with system versioning;
create view vt as select sys_trx_start, a from t;

create table emp
(
  emp_id int,
  name varchar(127),
  mgr int,
  salary int
) with system versioning;

insert into emp values (1, 'bill', 0, 1000),
                       (2, 'bill', 1, 1000),
		       (3, 'kate', 1, 133);
set @ts_6=now(6);
delete from emp;

with recursive
ancestors
as
(
  select e.emp_id, e.name, e.mgr, e.salary, e.sys_trx_start, e.sys_trx_end
  from emp as e for system_time as of timestamp @ts_6
  where name = 'bill'
  union 
  select e.emp_id, e.name, e.mgr, e.salary, e.sys_trx_start, e.sys_trx_end
  from emp as e for system_time as of timestamp @ts_6, ancestors as a for system_time as of timestamp @ts_6
  where e.mgr = a.emp_id
)
select * from ancestors for system_time as of timestamp @ts_6;

drop table emp;
